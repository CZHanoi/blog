import{_ as i,c as a,d as n,o as l}from"./app-Bo_rJeTf.js";const t="/blog/assets/install-Bj5u6Oip.jpg",e="/blog/assets/workflow-COv89jam.png",h="/blog/assets/pycisTopic1-CMtwDZxg.png",p="/blog/assets/pycisTopic2-Cp7cyHxH.png",k="/blog/assets/igv_pycistopic-B3ensJ8y.jpg",r="/blog/assets/qc-52XMAz7b.webp",d={};function g(c,s){return l(),a("div",null,s[0]||(s[0]=[n(`<p>链接指路:<a href="https://www.youtube.com/watch?v=QW63LLd1XC8&amp;t=2079s" target="_blank" rel="noopener noreferrer">SCENIC+ Stein Aerts lab seminar.</a></p><p>讲解者：Seppe De Winter，文章的二作，来自巨无霸的<a href="https://aertslab.org/" target="_blank" rel="noopener noreferrer">Stein Aerts Lab - VIB - KULeuven</a>组</p><h2 id="安装-install" tabindex="-1"><a class="header-anchor" href="#安装-install"><span>安装 Install</span></a></h2><p>这部分真的不想多说，因为众所周知的原因，；以及因为“pybigwig==0.3.23”的原因，Windows系统我试了很多次都没有成功。</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>git clone https://github.com/aertslab/scenicplus</span></span>
<span class="line"><span>#直播的时候这一步能秒完成，真的馋哭了</span></span>
<span class="line"><span>#git clone git@github.com:aertslab/scenicplus.git</span></span>
<span class="line"><span>mamba create --name scenicplus python=3.11.8</span></span>
<span class="line"><span>#推荐3.11版本</span></span>
<span class="line"><span>mamba activate scenicplus</span></span>
<span class="line"><span>cd scenicplus/</span></span>
<span class="line"><span>git checkout development</span></span>
<span class="line"><span>pip install .</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Notes:如果出现下面的报错，原因是git连不上（典）</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">fatal:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> unable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> access</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;https://github.com/aertslab/LoomXpy/&#39;:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Recv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> failure:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Connection</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> was</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reset</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  error:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> subprocess-exited-with-error</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  ×</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clone</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --filter=blob:none</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --quiet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://github.com/aertslab/LoomXpy</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;C:\\Users\\Hanoi\\AppData\\Local\\Temp\\pip-install-vyuu71m4\\loomxpy_152eb1f7ca014b02893fa317b79a7d6c&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> did</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> run</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> successfully.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  │</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> exit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> code:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 128</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  ╰─</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">See</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> above</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> output.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  note:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> This</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> error</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> originates</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> subprocess,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> likely</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> problem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> with</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pip.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">error:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> subprocess-exited-with-error</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">×</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clone</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --filter=blob:none</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --quiet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://github.com/aertslab/LoomXpy</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;C:\\Users\\Hanoi\\AppData\\Local\\Temp\\pip-install-vyuu71m4\\loomxpy_152eb1f7ca014b02893fa317b79a7d6c&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> did</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> run</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> successfully.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">│</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> exit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> code:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 128</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">╰─</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">See</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> above</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> output.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">note:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> This</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> error</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> originates</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> subprocess,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> likely</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> problem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> with</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pip.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个时候我的解决办法是换成美国的VPN(暂时)</p><p>有一个十分费力的安装方法，后面得单独开一个页面来讲述了😲</p><p>验证安装成功:</p><p>终端中直接运行</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">base</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) [chenzhh@nodecw4 ~]</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> conda</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> activate</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> scenicplus</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">scenicplus</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) [chenzhh@nodecw4 ~]</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> scenicplus</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   ____</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ____</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> _____</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> _</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   _</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ___</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ____</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  /</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ___</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ___</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">____</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">_</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> _/</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ___</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">_</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  \\___</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\|</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |   |  </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">_</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| |  </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| || | |   </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">_</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">_</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   ___</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) | |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">___</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">___</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  || | |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">_..._</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">____/</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\_</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">___</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">_____</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">_</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\_</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">___\\____</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">||</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">_</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">scenicplus</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> verions:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1.0a2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">usage:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> scenicplus</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [-h] {</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">init_snakemake,prepare_data,grn_inference}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Single-Cell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Enhancer-driven</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gene</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> regulatory</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Inference</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Clustering</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">positional</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> arguments:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  {</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">init_snakemake,prepare_data,grn_inference}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">options:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  -h,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --help</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> this</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> help</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> message</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> exit</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">scenicplus</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) [chenzhh@nodecw4 ~]</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pycistarget</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">██████╗</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ██╗</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ██╗</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ██████╗██╗███████╗████████╗</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> █████╗</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ██████╗</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  ██████╗</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ███████╗████████╗</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">██╔══██╗╚██╗</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ██╔╝██╔════╝██║██╔════╝╚══██╔══╝██╔══██╗██╔══██╗██╔════╝</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ██╔════╝╚══██╔══╝</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">██████╔╝</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ╚████╔╝</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ██║</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     ██║███████╗</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ██║</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ███████║██████╔╝██║</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  ███╗█████╗</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     ██║</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">██╔═══╝</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ╚██╔╝</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  ██║</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     ██║╚════██║</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ██║</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ██╔══██║██╔══██╗██║</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ██║██╔══╝</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     ██║</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">██║</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        ██║</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ╚██████╗██║███████║</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ██║</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ██║</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  ██║██║</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  ██║╚██████╔╝███████╗</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ██║</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">╚═╝</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        ╚═╝</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    ╚═════╝╚═╝╚══════╝</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ╚═╝</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ╚═╝</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  ╚═╝╚═╝</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  ╚═╝</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ╚═════╝</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ╚══════╝</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ╚═╝</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pycistarget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> version:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">usage:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pycistarget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [-h] {</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cistarget,dem}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Motif</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enrichment</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> analysis.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">positional</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> arguments:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  {</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cistarget,dem}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">options:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  -h,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --help</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> this</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> help</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> message</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> exit</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">scenicplus</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) [chenzhh@nodecw4 ~]</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pycistopic</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">usage:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pycistopic</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [-h] {</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">qc,topic_modeling,tss}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pycistopic:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> error:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> following</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> arguments</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> are</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> required:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> command</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Notes：不要问为什么pycistopic的输出是个error,因为De Winter讲的时候就是这样样子（）</p><div style="text-align:center;" id="fig0"><img src="`+t+'" style="width:80%;"><div><span style="color:gray;">Figure 0: Installed</span><br><br></div></div><h2 id="工作流-workflow-overlook" tabindex="-1"><a class="header-anchor" href="#工作流-workflow-overlook"><span>工作流 Workflow Overlook</span></a></h2><div style="text-align:center;" id="fig1"><img src="'+e+'" style="width:80%;"><div><span style="color:gray;">Figure 1: Workflow</span><br><br></div></div><p>主要目的从ATAC数据+Expression数据（multiomics data）推断<strong>enhancer driven</strong> GRNs。</p><p>主要流程分成了三个独立的仓库</p><p>①<code>aertslab/pycisTopic</code></p><p>处理ATAC数据，获得consensus peak。</p><p>②<code>aertslab/pycisTarget</code></p><p>推断潜在的TF和对应的Region，富集。</p><p>③<code>aertslab/scenicplus</code></p><p>结合Expression数据获得GRNs。</p><p>Notes：只推荐用于模式生物和人</p><h2 id="pycistopic" tabindex="-1"><a class="header-anchor" href="#pycistopic"><span>pycisTopic</span></a></h2><div style="text-align:center;" id="fig2a"><img src="'+h+'" style="width:80%;"><div><span style="color:gray;">Figure 2a: pycisTopic purpose</span><br><br></div></div><p>输入文件解释：</p><p>①每个样本的Fragmen.tsv.gz文件和index(.tbl)</p><p>②细胞注释（Github上有Issue写了无注释的方法，但极不推荐）</p><p>生成文件解释：</p><p>①bed文件 :存储Consensus peak set</p><p>②Imputed accessibility matrix*</p><p>Notes：插值的原因是scATAC-seq矩阵高度稀疏（对比scRNA-seq来说）</p><p>③bed文件 :存储Co-accessible regions（用于pycisTarget后续分析）</p><ul><li>Topics: 描述染色质的开放模式</li><li>DARs (Differencially accessible regions): 不同细胞类型或条件间有显著差异的区域。</li></ul><div style="text-align:center;" id="fig2b"><img src="'+p+`" style="width:80%;"><div><span style="color:gray;">Figure 2b: pycisTopic workflow</span><br><br></div></div><h3 id="_1推断共识峰-获取新的特征-infer-consensus-peak" tabindex="-1"><a class="header-anchor" href="#_1推断共识峰-获取新的特征-infer-consensus-peak"><span>①推断共识峰（获取新的特征）Infer Consensus Peak</span></a></h3><p>&lt;1&gt;Pseudo-Bulk Peak Sets的建立: <strong>Aggregate</strong> all of the reads coming from <strong>Barcodes of the same cell type</strong> into a <strong>single fragment file</strong>.</p><p>&lt;2&gt;Call Peaks on each individual fragment file per cell type.</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">narrow_peak_dict </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> peak_calling</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    macs_path</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> macs_path,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    bed_paths</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> bed_paths,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    outdir</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> os.path.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">join</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(os.path.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">join</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(out_dir, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;consensus_peak_calling/MACS&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)),</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    genome_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;hs&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    n_cpu</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    input_format</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;BEDPE&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    shift</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 73</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    ext_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 146</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    keep_dup</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;all&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    q_value</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.05</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    _temp_dir</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;/tmp&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>&lt;3&gt;共识整合Consensus peak: Merge all these peaks per cell type into a single Peak Set.</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> pycisTopic.iterative_peak_calling </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> get_consensus_peaks</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">peak_half_width</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">250</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#peak scale will be set as 500 base</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">path_to_blacklist</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;/public/home/chenzhh/packgae_python/pycisTopic/blacklist/hg38-blacklist.v2.bed&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Get consensus peaks</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">consensus_peaks </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> get_consensus_peaks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    narrow_peaks_dict</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> narrow_peak_dict,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    peak_half_width</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> peak_half_width,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    chromsizes</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> chromsizes,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    path_to_blacklist</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> path_to_blacklist)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#↓导出为bed文件</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">consensus_peaks.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">to_bed</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    path</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> os.path.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">join</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(out_dir, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;consensus_peak_calling/consensus_regions.bed&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    keep</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">True</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    compression</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;infer&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    chain</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> False</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div style="text-align:center;" id="fig2b"><img src="`+k+'" style="width:80%;"><div><span style="color:gray;">Figure 3a: IGV views of Peaks</span><br><br></div></div><p><strong>Notes:</strong></p><p>使用IGV看得到的结果，其中每一行都是一种细胞类型；</p><p>黑色的框则是最后计算得到的共识峰（Consensus peak）。后面的步骤则是<strong>以这些Consensus peak作为features，每个Cell Barcodes作为index重新生成matrix</strong>。</p><h3 id="_2qc" tabindex="-1"><a class="header-anchor" href="#_2qc"><span>②QC</span></a></h3><p>filter high quality Cell barcodes（个人觉得，如果之前做过了这步可以省略，而且De Winter讲到这里的时候翻车了hhhh）→generate account matrix</p><p>&lt;1&gt;简单介绍一下De Winter分享的如何看QC图（本人反正一直都是懵懵懂懂的）</p><div style="text-align:center;" id="fig2b"><img src="'+r+`" style="width:100%;"><div><span style="color:gray;">Figure 3b: QC</span><br><br></div></div><p>图Left:(Number of Fragment——Barcode Rank): 希望观察到的是一个sharp knee</p><p>图Middle(Fragment Ratio——Fragment Size): 长这个样子，两个峰分别代表mononucleosomal (单核小体)和dinucleosomal(双核小体)</p><p>图Right(TSS的Normalized Eenrichiment): 很漂亮的TSS enrichment</p><p>&lt;2&gt;生成cistopic_obj（）</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">pycistopic_qc_output_dir </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;outs/qc&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> pycisTopic.cistopic_class </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> create_cistopic_object_from_fragments</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> polars </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> pl</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">cistopic_obj_list </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> []</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sample_id </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> fragments_dict:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    sample_metrics </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> pl.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">read_parquet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        os.path.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">join</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(pycistopic_qc_output_dir, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">sample_id</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.fragments_stats_per_cb.parquet&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    ).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">to_pandas</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">set_index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;CB&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).loc[ sample_id_to_barcodes_passing_filters[sample_id] ]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    cistopic_obj </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> create_cistopic_object_from_fragments</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">        path_to_fragments</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> fragments_dict[sample_id],</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">        path_to_regions</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> path_to_regions,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">        path_to_blacklist</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> path_to_blacklist,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">        metrics</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sample_metrics,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">        valid_bc</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sample_id_to_barcodes_passing_filters[sample_id],</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">        n_cpu</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">        project</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sample_id,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">        split_pattern</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;-&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    )</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    cistopic_obj_list.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(cistopic_obj)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果不使用他们的QC，则将<code>metrics</code>和<code>valid_bc</code>设定为<code>None</code>，如下</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">path_to_regions </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> os.path.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">join</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(out_dir, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;consensus_peak_calling/consensus_regions.bed&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">path_to_blacklist </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;/public/home/chenzhh/packgae_python/pycisTopic/blacklist/hg38-blacklist.v2.bed&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> pycisTopic.cistopic_class </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> create_cistopic_object_from_fragments</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">cistopic_obj_list </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> []</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sample_id </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> fragments_dict:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    cistopic_obj </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> create_cistopic_object_from_fragments</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">        path_to_fragments</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> fragments_dict[sample_id],</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">        path_to_regions</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">   =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> path_to_regions,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">        path_to_blacklist</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> path_to_blacklist,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">        metrics</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">           =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> None</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">        valid_bc</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">          =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> None</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">        n_cpu</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">             =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">        project</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">           =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sample_id,</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">        split_pattern</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">     =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;-&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    )</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    cistopic_obj_list.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(cistopic_obj)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3topic-modeling" tabindex="-1"><a class="header-anchor" href="#_3topic-modeling"><span>③Topic modeling</span></a></h3><p>&lt;1&gt;Impute accessibility</p><p>&lt;2&gt;获得 Co-accessible Topics: Sets of Co-accessible Regions</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>wget -O data/fragments.tsv.gz https://cf.10xgenomics.com/samples/cell-arc/1.0.0/human_brain_3k/human_brain_3k_atac_fragments.tsv.gz</span></span>
<span class="line"><span>wget -O data/fragments.tsv.gz.tbi https://cf.10xgenomics.com/samples/cell-arc/1.0.0/human_brain_3k/human_brain_3k_atac_fragments.tsv.gz.tbi</span></span>
<span class="line"><span>wget -O data/cell_data.tsv https://raw.githubusercontent.com/aertslab/pycisTopic/polars/data/cell_data_human_cerebellum.tsv</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,62)]))}const A=i(d,[["render",g]]),o=JSON.parse('{"path":"/golden-rain/multi-omics-atac/scenicplus.html","title":"SCENIC+ 的网络研讨会笔记","lang":"en-US","frontmatter":{"title":"SCENIC+ 的网络研讨会笔记","date":"2025-05-12T00:00:00.000Z","cover":"scenic.jpg","category":["Multi-Omics & ATAC"],"tag":["scRNAseq","simulation","multi-omics","nature-methods"],"star":true,"article":true,"description":"链接指路:SCENIC+ Stein Aerts lab seminar. 讲解者：Seppe De Winter，文章的二作，来自巨无霸的Stein Aerts Lab - VIB - KULeuven组 安装 Install 这部分真的不想多说，因为众所周知的原因，；以及因为“pybigwig==0.3.23”的原因，Windows系统我试了很多次...","head":[["meta",{"property":"og:url","content":"https://czhanoi.github.io/blog/blog/golden-rain/multi-omics-atac/scenicplus.html"}],["meta",{"property":"og:site_name","content":"CZHanoi"}],["meta",{"property":"og:title","content":"SCENIC+ 的网络研讨会笔记"}],["meta",{"property":"og:description","content":"链接指路:SCENIC+ Stein Aerts lab seminar. 讲解者：Seppe De Winter，文章的二作，来自巨无霸的Stein Aerts Lab - VIB - KULeuven组 安装 Install 这部分真的不想多说，因为众所周知的原因，；以及因为“pybigwig==0.3.23”的原因，Windows系统我试了很多次..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-05-18T22:18:06.000Z"}],["meta",{"property":"article:tag","content":"scRNAseq"}],["meta",{"property":"article:tag","content":"simulation"}],["meta",{"property":"article:tag","content":"multi-omics"}],["meta",{"property":"article:tag","content":"nature-methods"}],["meta",{"property":"article:published_time","content":"2025-05-12T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-05-18T22:18:06.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"SCENIC+ 的网络研讨会笔记\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2025-05-12T00:00:00.000Z\\",\\"dateModified\\":\\"2025-05-18T22:18:06.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"CZHanoi\\",\\"url\\":\\"https://czhanoi.github.io/blog/\\"}]}"]]},"headers":[{"level":2,"title":"安装 Install","slug":"安装-install","link":"#安装-install","children":[]},{"level":2,"title":"工作流 Workflow Overlook","slug":"工作流-workflow-overlook","link":"#工作流-workflow-overlook","children":[]},{"level":2,"title":"pycisTopic","slug":"pycistopic","link":"#pycistopic","children":[{"level":3,"title":"①推断共识峰（获取新的特征）Infer Consensus Peak","slug":"_1推断共识峰-获取新的特征-infer-consensus-peak","link":"#_1推断共识峰-获取新的特征-infer-consensus-peak","children":[]},{"level":3,"title":"②QC","slug":"_2qc","link":"#_2qc","children":[]},{"level":3,"title":"③Topic modeling","slug":"_3topic-modeling","link":"#_3topic-modeling","children":[]}]}],"git":{"createdTime":1747606686000,"updatedTime":1747606686000,"contributors":[{"name":"CZHanoi","username":"CZHanoi","email":"21301010003@m.fudan.edu.cn","commits":1,"url":"https://github.com/CZHanoi"}]},"readingTime":{"minutes":4.53,"words":1359},"filePathRelative":"golden-rain/multi-omics-atac/scenicplus.md","localizedDate":"May 12, 2025","excerpt":"<p>链接指路:<a href=\\"https://www.youtube.com/watch?v=QW63LLd1XC8&amp;t=2079s\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">SCENIC+ Stein Aerts lab seminar.</a></p>\\n<p>讲解者：Seppe De Winter，文章的二作，来自巨无霸的<a href=\\"https://aertslab.org/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Stein Aerts Lab - VIB - KULeuven</a>组</p>","autoDesc":true}');export{A as comp,o as data};
